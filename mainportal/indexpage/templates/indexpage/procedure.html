{% extends 'layout/layout.html' %}

{% block head %}
<title>Base</title>
{% endblock %}
<!-- -------------------------------------------------------------------- -->
{% block body_left %}

{% endblock %}
{% block body_right %}
<h2>{{ page_name }}</h2>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-6" style="background-color: #ffffff; text-align: center; min-height: 100%;">
            {% if procedure %}
            <table class="table table-striped table-sm">
                <tr><th>{{ procedure.proc_number|safe }}</th></tr>
                <tr><td>{{ procedure.law__full_name|safe }}</td></tr>
                <tr><td>{{ procedure.type_proc__full_name|safe }}</tr></td>
                <tr><td>{{ procedure.orgs__full_name|safe }}</tr></td>
                <tr><td>{{ procedure.orgs__inn|safe }}</tr></td>
                <tr><td>{{ procedure.subject|safe }}</tr></td>
                <tr><td>{{ procedure.date_start }}</tr></td>
                <tr><td>{{ procedure.date_end }}</tr></td>
                <tr><td>{{ procedure.date_proc }}</tr></td>
                <tr><td><a href="{{ procedure.link|safe }}" target="_blank" >{{ procedure.tradeplace__full_name|safe }}</a></tr></td>
                <tr><td>{{ procedure.stage__full_name|safe }}</tr></td>
                <tr><td>{{ procedure.created_at|safe }}</tr></td>
                <tr><td>{{ procedure.deal_count|safe }}</tr></td>
                <tr><td>{{ procedure.region__full_name|safe }}</tr></td>
            </table>
            {% else %}
            <h2>No Data</h2>
            {% endif %}
        </div>
        <div class="col-md-6" style="background-color: #ffffff; min-height: 100%;">
            <form method="post">
                {% csrf_token %}
                <table>
                    <tr><td>{{ my_org_form.my_org.label }}</td> <td>{{ my_org_form.my_org }}</td></tr>
                    <tr><td>{{ new_orders_form.amount.label }} </td> <td> {{ new_orders_form.amount }}</td></tr>
                    <tr><td>{{ new_orders_form.comment.label }} </td> <td> {{ new_orders_form.comment }}</td></tr>
                </table>
                <button type="submit" class="btn btn-primary" name="add">Добавить</button>
            </form>
        </div>
    </div>
    {% for elem in orders %}
    <div class="row">
        <div class="col-md-6" style="background-color: #ffffff; min-height: 100%;">
            {% with elem.get_orders_form as form %}
            <form style="background-color: #c1b2b2" method="post">
                {% csrf_token %}
                <table>
                    <h4>Организация: {{elem}}</h4>
                    <button style="text-align: center;" type="submit" class="btn btn-danger" name="delete" value="{{elem.pk}}">x</button>
                    <tr><td>{{ form.amount.label }} </td> <td> {{ form.amount }}</td></tr>
                    <tr><td>{{ form.comment.label }} </td> <td> {{ form.comment }}</td></tr>
                    <tr><td>{{ form.win.label }} </td> <td> {{ form.win }}</td></tr>
                </table>
                <button type="submit" class="btn btn-primary" name="update" value="{{elem.pk}}">Обновить</button>
            </form>
            {% endwith %}
        </div>
        {% if elem.win %}
        <div class="col-md-6" style="background-color: #ffffff; min-height: 100%;">
            {% with elem.get_contracts_form as form %}
            <form style="background-color: #9c8686" method="post">
                {% csrf_token %}
                <table>
                    <tr><td>{{ form.contract_num.label }}</td><td>{{ form.contract_num }}</td></tr>
                    <tr><td>{{ form.contract_date.label }}</td><td>{{ form.contract_date }}</td></tr>
                    <tr><td>{{ form.deadline.label }}</td><td>{{ form.deadline }}</td></tr>
                    <tr><td>{{ form.day_to_shipping.label }}</td><td>{{ form.day_to_shipping }}</td></tr>
                    <tr><td>{{ form.comment.label }}</td><td>{{ form.comment }}</td></tr>
                </table>
                <button type="submit" class="btn btn-primary" name="update_contract" value="{{elem.pk}}">Обновить</button>
            </form>
            {% endwith %}
        </div>
        {% endif %}
    </div></br>
    {% endfor %}
</div>
{% endblock %}